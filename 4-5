# 4.4 SQL 呼び出しに伴う脆弱性

## 攻撃手法と理屈とその対策

### エラーメッセージ経由の情報漏えい 
この攻撃では、意図的にエラーメッセージを出力させ、その内容からユーザーIDやパスワードなどを取得したりします。

対策としては、エラーメッセージに内部的なエラー内容は含ませないようにすることが挙げられます。

### UNION SELECTを用いた情報漏えい
この攻撃は、UNION演算子を用いて情報を抜き出すものです。
具体的には、元のSQL文に対して'+UNION+SELECT+id,pwd, ~ のような文を追加し、ユーザーIDやパスワードを盗み見ることができます。
- UNION演算子：SELECTの結果を統合して表示してくれる

対策としては、「'」をエスケープ処理するか、プリペアドステートメントを使うことが挙げられます。
- プリペアドステートメント：ユーザーが値を入力する前にSQL文を確定させるもの

### SQLインジェクションによる認証回避
この攻撃は、ログイン画面でパスワードの入力フォームに「 ' or 'a'='a 」と入力することで、不正にログインするものです。
「or」で「または」、「a=a」で「ture」になり、正しいと判断されログインできてしまいます。

対策としては、「'」をエスケープ処理するか、プリペアドステートメントを使うことが挙げられます。

### SQLインジェクション攻撃によるデータ改ざん
この攻撃は、「' ; UPDATE」を入力することで、データ改ざんを行う手法です。
これまでの攻撃と同じように、文字リテラルが正しく構成されていないサイトに「'」をつかうことでSQL文だと認識させるものです。

こちらも対策としては、「'」のエスケープ処理やプリペアドステートメントで対策できます。
